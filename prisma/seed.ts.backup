import { PrismaClient } from '@prisma/client'
import { hash } from 'bcryptjs'

const prisma = new PrismaClient()

async function main() {
  // Create admin user
  const adminPassword = await hash('Admin123!', 12)
  const admin = await prisma.user.upsert({
    where: { email: 'admin@goodwillmedical.com' },
    update: {},
    create: {
      email: 'admin@goodwillmedical.com',
      password: adminPassword,
      name: 'Admin User',
      role: 'ADMIN'
    }
  })

  // Create categories
  const categories = await Promise.all([
    prisma.category.create({
      data: {
        name: 'Mobility Aids',
        slug: 'mobility-aids',
        description: 'Wheelchairs, walkers, and mobility scooters',
        icon: 'ðŸ¦½',
        order: 1
      }
    }),
    prisma.category.create({
      data: {
        name: 'Respiratory Equipment',
        slug: 'respiratory-equipment',
        description: 'Oxygen concentrators, CPAP machines, ventilators',
        icon: 'ðŸ’¨',
        order: 2
      }
    }),
    prisma.category.create({
      data: {
        name: 'Hospital Furniture',
        slug: 'hospital-furniture',
        description: 'Hospital beds, examination tables, patient chairs',
        icon: 'ðŸ›ï¸',
        order: 3
      }
    }),
    prisma.category.create({
      data: {
        name: 'Diagnostic Devices',
        slug: 'diagnostic-devices',
        description: 'Blood pressure monitors, stethoscopes, thermometers',
        icon: 'ðŸ©º',
        order: 4
      }
    }),
    prisma.category.create({
      data: {
        name: 'PPE & Disposables',
        slug: 'ppe-disposables',
        description: 'Masks, gloves, gowns, sanitizers',
        icon: 'ðŸ§¤',
        order: 5
      }
    }),
    prisma.category.create({
      data: {
        name: 'Home Care Supplies',
        slug: 'home-care-supplies',
        description: 'Daily living aids, bathroom safety, incontinence care',
        icon: 'ðŸ ',
        order: 6
      }
    })
  ])

  // Create sample products
  for (const category of categories) {
    await prisma.product.create({
      data: {
        sku: `MED-${category.name.slice(0, 3).toUpperCase()}-001`,
        name: `Premium ${category.name}`,
        slug: `premium-${category.slug}`,
        description: `High-quality ${category.name.toLowerCase()} for professional medical use.`,
        shortDescription: `Professional-grade ${category.name.toLowerCase()}`,
        categoryId: category.id,
        brand: 'Goodwill Medical',
        price: 299.99,
        inventory: 50,
        images: {
          create: [
            {
              url: 'https://via.placeholder.com/600x400?text=Product+Image',
              alt: `${category.name} product image`,
              order: 1
            }
          ]
        },
        specifications: {
          create: [
            { name: 'Material', value: 'Medical-grade materials' },
            { name: 'Warranty', value: '2 years' },
            { name: 'Certification', value: 'FDA, CE' },
            { name: 'Weight Capacity', value: '300 lbs' }
          ]
        },
        deliveryEstimate: '2-3 business days',
        isFeatured: true,
        tags: ['premium', 'featured', category.slug]
      }
    })
  }

  console.log('Database seeded successfully!')
}

main()
  .catch((e) => {
    console.error(e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })